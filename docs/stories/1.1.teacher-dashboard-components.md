# Story 1.1: Teacher Dashboard Components

## Status

**Ready for Review**

## Story

**As a** Sunday School teacher,
**I want** a dedicated dashboard that shows my classes, pending actions, and key stats at a glance,
**so that** I can quickly understand what needs my attention and take action efficiently.

## Acceptance Criteria

1. Teacher sees a welcome banner with their name and church upon landing on dashboard
2. Dashboard displays 4 stat cards: Classes count, Pending actions count, Total students, Attendance rate
3. Stat cards are clickable and navigate to respective sections
4. Primary "Take Attendance" button is prominently displayed below stats
5. "Action Required" section shows grouped pending items (trips, competitions, activities)
6. Bottom navigation shows 5 items with appropriate badges for counts
7. All components support dark mode
8. All components are accessible (keyboard navigation, screen reader support)
9. Layout is responsive (mobile-first, adapts to tablet/desktop)
10. Components support RTL layout for Arabic language

## Tasks / Subtasks

- [x] Task 1: Create StatCard component (AC: 2, 3, 7, 8, 9, 10)
  - [x] Create `src/components/teacher/StatCard.tsx` with TypeScript interface
  - [x] Implement icon, value, label display
  - [x] Add variant support (default, highlight, warning)
  - [x] Add loading skeleton state
  - [x] Add hover animation (lift + shadow)
  - [x] Add click handler and navigation support
  - [x] Ensure 44px minimum touch target
  - [x] Add dark mode support
  - [x] Add RTL support

- [x] Task 2: Create ActionRequiredCard component (AC: 5, 7, 8, 9, 10)
  - [x] Create `src/components/teacher/ActionRequiredCard.tsx` with TypeScript interface
  - [x] Implement type-based icon display (trip, competition, activity)
  - [x] Display title, count, subtitle
  - [x] Add "View" action button
  - [x] Add hover state with shadow
  - [x] Add dark mode support
  - [x] Add RTL support

- [x] Task 3: Create QuickAttendanceButton component (AC: 4, 7, 8, 9, 10)
  - [x] Create `src/components/teacher/QuickAttendanceButton.tsx`
  - [x] Implement single-class direct navigation variant
  - [x] Implement multi-class dropdown selector variant
  - [x] Style as prominent primary CTA
  - [x] Add loading state
  - [x] Add dark mode support

- [x] Task 4: Create TeacherBottomNav component (AC: 6, 7, 8, 9, 10)
  - [x] Create `src/components/teacher/TeacherBottomNav.tsx`
  - [x] Implement 5 nav items with icons and labels
  - [x] Add badge support for counts
  - [x] Implement active state styling
  - [x] Add conditional rendering for "My Trips" (only if organizing)
  - [x] Ensure fixed positioning at bottom
  - [x] Add dark mode support
  - [x] Add keyboard navigation support

- [x] Task 5: Create TeacherDashboard page (AC: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
  - [x] Create `src/app/dashboard/teacher/page.tsx`
  - [x] Add welcome banner with teacher name and church
  - [x] Implement 2x2 stats grid (mobile) / 4x1 (desktop)
  - [x] Add Quick Attendance button section
  - [x] Add Action Required section with grouped items
  - [x] Integrate TeacherBottomNav
  - [x] Add loading states with skeletons
  - [x] Add empty state for no pending actions
  - [x] Connect to server actions for data fetching

- [x] Task 6: Create server actions for teacher data (AC: 2, 5)
  - [x] Create `src/app/dashboard/teacher/actions.ts`
  - [x] Implement `getTeacherDashboardData()` - fetch stats, pending items
  - [x] Implement `getTeacherClasses()` - fetch assigned classes
  - [x] Implement `getPendingActions()` - fetch pending approvals
  - [x] Add proper error handling
  - [x] Add Supabase RLS filtering for teacher's data only

- [x] Task 7: Add i18n translations (AC: 10)
  - [x] Add English translations to `messages/en.json` under `teacher` namespace
  - [x] Add Arabic translations to `messages/ar.json` under `teacher` namespace

- [ ] Task 8: Write component tests (BLOCKED - No test framework configured)
  - [ ] Test StatCard renders correctly with all variants
  - [ ] Test ActionRequiredCard displays correct icons per type
  - [ ] Test TeacherBottomNav badge display logic
  - [ ] Test TeacherDashboard page renders all sections

## Dev Notes

### Existing Patterns to Follow

**Component Structure (from existing codebase):**
```typescript
// Use CVA for variants (see src/components/ui/button.tsx)
import { cva, type VariantProps } from "class-variance-authority"
import { cn } from "@/lib/utils"

// Add data-slot for testing hooks
<div data-slot="stat-card" className={cn(...)}>
```

**Styling Conventions:**
- Use Tailwind with `cn()` utility for class merging
- Dark mode via `dark:` prefixes
- Mobile-first: default styles, then `sm:`, `lg:`
- Touch targets: `min-h-11` (44px)

**Icon Usage:**
```typescript
import { BookOpen, Zap, Users, BarChart3, Bus, Trophy, ClipboardList } from "lucide-react"
```

**Existing Components to Reuse:**
- `Card`, `CardContent` from `@/components/ui/card`
- `Badge` from `@/components/ui/badge`
- `Button` from `@/components/ui/button`
- `Skeleton` from `@/components/ui/skeleton`
- `EmptyState` from `@/components/ui/empty-state`

### Design Tokens

```css
/* Colors (from globals.css - OKLch) */
--primary: oklch(0.32 0.03 240);  /* #2a3f54 dark blue-gray */
--secondary: oklch(0.7 0.1 195); /* #58b7bd teal */
--accent: oklch(0.78 0.14 80);   /* #e3ab4a golden */
```

### Data Types

```typescript
interface StatCardProps {
  icon: LucideIcon
  value: string | number
  label: string
  href: string
  variant?: 'default' | 'highlight' | 'warning'
  loading?: boolean
}

interface ActionRequiredItem {
  id: string
  type: 'trip' | 'competition' | 'activity'
  title: string
  count: number
  subtitle?: string
  href: string
}

interface TeacherDashboardData {
  teacher: { name: string; church: string }
  stats: {
    classes: number
    pending: number
    students: number
    attendanceRate: number
  }
  actionRequired: ActionRequiredItem[]
}
```

### File Structure

```
src/
├── app/dashboard/teacher/
│   ├── page.tsx              # Main dashboard page
│   ├── actions.ts            # Server actions
│   └── loading.tsx           # Loading skeleton
├── components/teacher/
│   ├── StatCard.tsx
│   ├── ActionRequiredCard.tsx
│   ├── QuickAttendanceButton.tsx
│   └── TeacherBottomNav.tsx
```

### Testing

**Test Location:** `__tests__/components/teacher/`

**Testing Framework:** Vitest + React Testing Library

**Test Patterns:**
```typescript
import { render, screen } from '@testing-library/react'
import { describe, it, expect } from 'vitest'

describe('StatCard', () => {
  it('renders with correct value and label', () => {
    render(<StatCard icon={BookOpen} value={3} label="Classes" href="/classes" />)
    expect(screen.getByText('3')).toBeInTheDocument()
    expect(screen.getByText('Classes')).toBeInTheDocument()
  })
})
```

### Reference Document

Full UI/UX specification: `docs/teacher-dashboard-front-end-spec.md`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-10 | 1.0 | Initial story creation | James (Dev) |

---

## Dev Agent Record

### Agent Model Used

Claude Opus 4.5 (claude-opus-4-5-20251101)

### Debug Log References

No debug issues encountered.

### Completion Notes List

1. **Tasks 1-7 Completed Successfully**
   - All 4 teacher components created with full TypeScript types
   - Dashboard page with server actions implemented
   - i18n translations added for English and Arabic
   - Teacher redirect added to main dashboard

2. **Task 8 (Tests) - Blocked**
   - No testing framework (Vitest/Jest) is configured in this project
   - Test infrastructure needs to be set up before component tests can be written
   - Recommend adding Vitest + React Testing Library as a separate story

3. **TypeScript Verification**
   - All components pass TypeScript strict mode check
   - No type errors in teacher-related files

### File List

**Created:**
- `src/components/teacher/StatCard.tsx`
- `src/components/teacher/ActionRequiredCard.tsx`
- `src/components/teacher/QuickAttendanceButton.tsx`
- `src/components/teacher/TeacherBottomNav.tsx`
- `src/components/teacher/index.ts`
- `src/app/dashboard/teacher/page.tsx`
- `src/app/dashboard/teacher/actions.ts`
- `src/app/dashboard/teacher/loading.tsx`

**Modified:**
- `src/app/dashboard/page.tsx` (added teacher redirect)
- `messages/en.json` (added teacher namespace)
- `messages/ar.json` (added teacher namespace)

---

## QA Results

*To be filled by QA Agent*
